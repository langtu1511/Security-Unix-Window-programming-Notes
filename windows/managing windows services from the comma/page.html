<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Managing Windows Services from the command line</title>
</head><body><br/>
<br/>
<br/>
<div style="text-align: center"><span style="font-size: 12pt"><b><a href="http://www.jasonn.com/enable_windows_services_command_line">Managing Windows Services from the command line </a></b></span></div>&nbsp;<br/>
<br/>
<br/>
<br/>
Sometimes people disable Windows Services and can't get the Windows Services screen to enable a necessary service. The easiest route is to circumvent that interface and go straight to the command line. You can also do this from Safe Mode.<br/>
<br/>
<img src="enable_service_command_line_01_0.jpg" width="165" height="300" /><br/>
<br/>
To get there while running Windows, click on Start, then Run.<br/>
<br/>
<img src="enable_service_command_line_02.jpg" /><br/>
<br/>
<br/>
Type in cmd and click OK to enter the command line mode.Get a list of inactive services to help find the one that you need to enable.<br/>
<ul><li style="list-style-type: none"><tt><span style="color: #00007f">sc query type= service state= inactive | more</span></tt></li>
</ul>
<br/>
The sc query is a command to tell Windows you want to query a service. The type tells it what specific group you want and the state tells it you want to see a grouping by it status: active, inactive and all respectively. More keeps you from watching a bunch of text whiz past meaninglessly. You can hit the space bar to page down. More is a reader or a text viewer utility in the command line. It's like a mini non-readable notepad. You can also pipe this (the | character is pipe command) to other readers or cat (the &gt; character is a cat command) to a file and read it. I suggest the &gt; option if you have a working OS well enough that you can open a text file.<br/>
<br/>
For example:<br/>
<ul><li style="list-style-type: none"><span style="color: #00007f">sc query type= service state= inactive &gt; C:\broken_services_list.txt</span></li>
</ul>
<br/>
Run that command and then you can open the file <tt><span style="color: #00007f">C:\broken_services_list.txt </span></tt>in notepad and make noes, choose services to modidy and work on your PC one item at a time. It's actually quite efficient.<br/>
<br/>
There's more than one way to get what you need. This one method.<br/>
<br/>
This gives you a nice little text file you can open, edit, take notes, etc.<br/>
<br/>
<img src="enable_service_command_line_04_0.jpg" /><br/>
<br/>
It may help you to copy and paste (select, right click and click copy and then right click in the command window and select paste) the service name to avoid misspelling it.<br/>
<br/>
<img src="enable_service_command_line_06_1.jpg" /><br/>
<br/>
Once you map out your problems, you can start enabling services again.<br/>
<br/>
The syntax is:<ul><li style="list-style-type: none"><tt><span style="color: #00007f">sc config servicename start= auto</span></tt></li>
</ul>
<br/>
Here's an example:<ul><li style="list-style-type: none"><tt><span style="color: #00007f">sc config messenger start= auto</span></tt></li>
</ul>
<br/>
Now, I'd never encourage you to enable the Messenger service, but it's off and in our list and you can see here it successfully enabled it.<br/>
<br/>
<img src="enable_service_command_line_09_1.jpg" /><br/>
<br/>
Now, we could just do this with a series of services and restart the PC to see if stuff starts working properly again. Or, you can then actually start the service since it's been enabled.<br/>
<br/>
<img src="enable_service_command_line_10_1.jpg" /><br/>
<br/>
To step backward, just change a few commands. If you wish to stop and then disable a particular Windows Service the following will work.<br/>
<br/>
<img src="enable_service_command_line_11.jpg" /><br/>
<br/>
In this case, I'm stopping and disabling Messenger because I consider it unsafe.<br/>
<br/>
To stop the service, I key in the following and hit enter:<br/>
<ul><li style="list-style-type: none"><span style="color: #00007f"><tt>sc stop messenger</tt></span></li>
</ul>
<br/>
To disable it, I key in the following and hit enter:<br/>
<ul><tt><span style="color: #00007f"><li style="list-style-type: none">sc config messenger start= disable</li>
</span></tt><li style="list-style-type: none"></li>
</ul>
NOTE: a reader says the proper command is actually:<br/>
<ul><li style="list-style-type: none"><span style="color: #00007f"><tt>sc config messenger start= disabled</tt></span></li>
</ul>
<br/>
See the missing (d) in my original. Make sure you try that out if it fails to work.<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
END</body></html>